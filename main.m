clear all
lambda=1;
A=[-2*lambda -lambda^2;1 0];
B=[1;0]; %G
C=(lambda^2).*[-2*lambda -lambda^2;1 0;0 1]; %H
D=lambda^2.*[1;0;0];
h=0.2;
sys1=ss(A,B,C,D);
sys2=c2d(sys1,h)
I=eye(2);
Ad=[0.655 -0.1637;0.1637 0.9825];
Bd=[0.1637;0.01752];
Cd=[-2 -1;1 0;0 1];
Dd=[1;0;0];
[num,den] = ss2tf(Ad,Bd,Cd,Dd)
num1=[1 -1.9824 0.9824];
num2=[0 0.1637 -0.1637];
num3=[0 0.0175 0.0153];
TransferFunction=tf(num1,den,h)*tf(num2,den,h)*tf(num3,den,h) % continuous transfer function
%dsys = c2d(sys,h, 'z');

b0= 0.002865;
b1=0.006039;
b2= 0.001024;
b3=0.004611;
b4=0.002461
a0=1;
a1=4.913;
a2=10.06;
a3=10.98;
a4=6.74;
a5=- 2.207;
a6=0.3012;
b=[b0 b1 b2 b3 b4];
a=[a0 a1 a2 a3 a4 a5 a6];
w=randn(1,297); %input noise
v=randn(1,297); %output noise
T=100;
P0=100*eye(2);
input=[0 0	0	0	0	0	0	0	0	0	0	0 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0 -0.7	-2.4	-4.1	-5.8	-7.5	-9.2	-10.9	-12.6	-14.3	-16	-17.7	-19.4	-21.1	-22.8	-24.5	-26.2	-27.9	-29.6	-31.3	-33 -31.97	-30.94	-29.91	-28.88	-27.85	-26.82	-25.79	-24.76	-23.73	-22.7	-21.67	-20.64	-19.61	-18.58	-17.55	-16.52	-15.49	-14.46	-13.43	-12.4	-11.37	-10.34	-9.31	-8.28	-7.25	-6.22	-5.19	-4.16	-3.13	-2.1 -2.4	-2.8	-3.2	-3.6	-4	-4.4	-4.8	-5.2	-5.6	-6 -5.734	-5.468	-5.202	-4.936	-4.67	-4.404	-4.138	-3.872	-3.606	-3.34	-3.074	-2.808	-2.542	-2.276	-2.01	-1.744	-1.478	-1.212	-0.946	-0.68	-0.414	-0.148	0.118	0.384	0.65	0.916	1.182	1.448	1.714	1.98 1.8	1.6	1.4	1.2	1	0.8	0.6	0.4	0.2	0	-0.2	-0.4	-0.6	-0.8	-1	-1.2	-1.4	-1.6	-1.8	-2 -1.867	-1.734	-1.601	-1.468	-1.335	-1.202	-1.069	-0.936	-0.803	-0.67	-0.537	-0.404	-0.271	-0.138	-0.005	0.128	0.261	0.394	0.527	0.66	0.793	0.926	1.059	1.192	1.325	1.458	1.591	1.724	1.857	1.99 1.2	0.4	-0.4	-1.2	-2	-2.8	-3.6	-4.4	-5.2	-6	-6.8	-7.6	-8.4	-9.2	-10	-10.8	-11.6	-12.4	-13.2	-14	-14.8	-15.6	-16.4	-17.2	-18	-18.8	-19.6	-20.4	-21.2	-22 -21.27	-20.54	-19.81	-19.08	-18.35	-17.62	-16.89	-16.16	-15.43	-14.7	-13.97	-13.24	-12.51	-11.78	-11.05	-10.32	-9.59	-8.86	-8.13	-7.4	-6.67	-5.94	-5.21	-4.48	-3.75	-3.02	-2.29	-1.56	-0.83	-0.1 -0.4	-0.8	-1.2	-1.6	-2	-2.4	-2.8	-3.2	-3.6	-4 -3.8	-3.6	-3.4	-3.2	-3	-2.8	-2.6	-2.4	-2.2	-2	-1.8	-1.6	-1.4	-1.2	-1	-0.8	-0.6	-0.4	-0.2 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0 0	0	0	0	0	0	0 0 0 0 0];
output=[0	0	0	0	0	0 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0 -0.6	-1.2	-1.8	-2.4	-3	-3.6	-4.2	-4.8	-5.4	-6 -6.066	-6.132	-6.198	-6.264	-6.33	-6.396	-6.462	-6.528	-6.594	-6.66	-6.726	-6.792	-6.858	-6.924	-6.99 -5.3	-3.6	-1.9	-0.2	1.5	3.2	4.9	6.6	8.3	10 9.8	9.6	9.4	9.2	9	8.8	8.6	8.4	8.2	8 7.2	6.4	5.6	4.8	4	3.2	2.4	1.6	0.8	0 -0.8	-1.6	-2.4	-3.2	-4	-3.8	-3.6	-3.4	-3.2	-3	-2.8	-2.6	-2.4	-2.2	-2	-1.8	-1.6	-1.4	-1.2	-1	-0.8	-0.6	-0.4	-0.2	0 0.15	0.3	0.45	0.6	0.75	0.9	1.05	1.2	1.35	1.5	1.15	0.8	0.45	0.1	-0.25	-0.6	-0.95	-1.3	-1.65	-2	-1.8	-1.6	-1.4	-1.2	-1	-0.8	-0.6	-0.4	-0.2	0 0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0 -0.33	-0.66	-0.99	-1.32	-1.65	-1.98	-2.31	-2.64	-2.97	-3.3	-3.63	-3.96	-4.29	-4.62	-4.95 -4.8	-4.6	-4.4	-4.2	-4 -4	-4	-4	-4	-4	-4	-4	-4	-4	-4 -3	-2	-1	0	1	2	3	4	5	6 6	6	6	6	6 5.1	4.2	3.3	2.4	1.5	0.6	-0.3	-1.2	-2.1	-3 -3.2	-3.4	-3.6	-3.8	-4	-3.8	-3.6	-3.4	-3.2	-3	-2.8	-2.6	-2.4	-2.2	-2	-1.8	-1.6	-1.4	-1.2	-1	-0.8	-0.6	-0.4	-0.2	0	0.2	0.4	0.6	0.8	1 0.8	0.6	0.4	0.2	0	-0.2	-0.4	-0.6	-0.8	-1 -0.8	-0.6	-0.4	-0.2	0 0	0	0	0	0	0	0	0	0	0	0	0	0	0 0 0 0 0 0 0 0 0 0];																								
la=length(a);
lb=length(b);
delay=1;
TransferFunction2= RLS( input, output, lb, la, delay, 1) 